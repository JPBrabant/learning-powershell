# Shell

## Installing

Start by installing or update to the latest version of Windows Terminal and PowerShell (7.5). There is a Preview version of PowerShell but it does not allow you to lunch a script with the `pwsh` command so stick to the official release.

	winget install --exact --id Microsoft.WindowsTerminal

	winget install --exact --id Microsoft.PowerShell

	winget install --exact --id Microsoft.Edit

## Lunching a script

After installing PowerShell, a new profile called PowerShell will appear in the Windows Terminal.

You can also lunch script from cmd.exe with

	pwsh -ExecutionPolicy Bypass -NoExit -File .\Main.ps1

The direct path to pwsh is `C:\Program Files\PowerShell\7\pwsh.exe`

## Usefull Terminal shortcut

### Auto complete `TAB`

### Menu complete `CTRL+SPACE`

### Accepts inline suggestion `Right Arrow`

### Switch between InlineView and ListView for suggestion `F2`

### Show command Help `F1`
Placing the cursor at the end of a full command name will open the Full Help page in a different buffer.

### Focused parameter help `ALT+H`
Placing the cursor at the end of a parameter, this command will show you help about this parameter. 

### Selecting arguments value `ALT+A`
Move the cursor to the next value of a parameter. 


## Configuring the Terminal

In the `Settings` page of Windows Terminal

1. Hide the `Windows PowerShell` profile. This is the old Windows built-in PowerShell (v5).

2. Use the `Open JSON file` button at the bottom to reorder the profile and put PowerShell as the first one. 

3. Downlaod and install a Nerd Font. This is a font that include many built-in icon. Download the CaskaydiaMono Nerd Font at 

	<https://www.nerdfonts.com/font-downloads>

	There is also CaskaydiaCove with ligatures that allow to merge caracter like `=>` to an arrow but I don't like that.

	In the downloaded zip file, install all the one named `CaskaydiaMonoNerdFont-[Regular|Bold|...].ttf`. Don't use the one with `NerdFontMono` or `NerdFontPropo` in the name. Install all the different wight (regular, bold, ...).

3. In the `Defaults` profile, go to `Appearance`

	- Color scheme : Campbell
	- Font face : CaskaydiaMono Nerd Font (default font face is Cascadia Mono)
	- Font size : 11 (default is 12)

4. Oh My Posh

	Oh My Posh allow you to customize the prompt of the terminal. 

		winget install --exact --id JanDeDobbeleer.OhMyPosh

	Then add it to your PowerShell personnal profile (equivalent to .bashrc).

	The path is `C:\Users\[username]\Documents\PowerShell\Microsoft.PowerShell_profile.ps1`

	If the file does not exist you can create it with 

	```PowerShell
	New-Item -Type File -Path $PROFILE 
	```

	Edit with

		notepad $PROFILE

	or

		edit $PROFILE

	And add the following line for the default theme

		oh-my-posh init pwsh | Invoke-Expression

		or

		oh-my-posh init pwsh --config 'catppuccin_mocha' | Invoke-Expression

5. [Catppuccin](https://catppuccin.com/)

	Color theme for the terminal available on [Github](https://github.com/catppuccin/windows-terminal).

    - **Latte** : Lightest
    - **Frapp√©** 
    - **Macchiato**
    - **Mocha** : Darkest (the one I use)

	