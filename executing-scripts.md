# Executing a script from within PowerShell

```pwsh
. .\script.ps1 # Dot sourcing, load and run a script in the current PowerShell session (share variables)

& .\script.ps1 # Call operator, ONLY send variables in a child process

Start-Process pwsh -ArgumentList '-File .\script.ps1' # Start a new process

Invoke-Expression "Get-Process | Where-Object CPU -gt 100" # Execute a string
iex

Invoke-Command -ScriptBlock { Get-Process }
icm

```

# Executing a script from `cmd.exe`

```cmd
pwsh -NoExit -NoLogo -NoProfile -ExecutionPolicy Bypass -File .\script.ps1
```

## pwsh arguments

### `-NoExit`

Keep the Terminal open after the script execution.

### `-NoLogo`

Suppress the PowerShell banner on startup (hides version info, update notifications, and profile load time). Useful for cleaner script execution output.

### `-ExecutionPolicy <executionPolicy>`

Start by checking your current **execution policy** with:

```pwsh
Get-ExecutionPolicy -List
```

- `Restricted`   — No scripts can run, not even signed ones, only interactive commands allowed
- `AllSigned`    — Only scripts signed by a trusted publisher can run, applies to both local and remote scripts
- `RemoteSigned` — Local scripts run without signature, downloaded scripts must be signed by a trusted publisher
- `Unrestricted` — All scripts can run, warns before running downloaded scripts
- `Bypass`       — Everything runs without restriction, no warnings, no prompts, no blocks

Set a global execution policy:

```pwsh
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope (CurrentUser|LocalMachine)
```

Bypass execution policy for a single script:

```cmd
pwsh -ExecutionPolicy Bypass -File <filePath>
```

### `-NoProfile`

Skip loading the user profile on startup. Speeds up startup significantly and ensures a clean environment without custom aliases or functions.

### `-WorkingDirectory <directoryPath>`

Set the working directory for the script execution.

### `-File <filePath> [args]`

Execute a script file. This argument must be last because everything after it is passed as arguments to your script, not to PowerShell itself.

### `-Command <command> [args]`

Execute a PowerShell command. This argument must be last because everything after it is passed as arguments to the command.

```cmd
pwsh -Command "Get-Process | Where-Object {$_.Memory -gt 100MB}"
```

### `-Verbose`

This is an argument for your script and not for `pwsh` itself. Must be placed after `-Command` or `-File`.

Enable verbose output for your script. Displays all messages generated by `Write-Verbose` statements in your code and enables detailed diagnostic information.

```cmd
pwsh -File script.ps1 -Verbose
```